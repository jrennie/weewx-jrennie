TODO, in decreasing order of importance.

A few "del" here and there might reduce memory requirements.